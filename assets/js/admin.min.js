jQuery(function(i){function r(t,a){i("#wpwrap").addClass("wf-alert-container"),i(".wf-alert-container").prepend('\t\t\t\t\t\t\t\t\t<div id="wf-alert-overlay">\t\t\t\t\t\t\t\t\t\t<div id="wf-alert-popup" class="'+a+'">\t\t\t\t\t\t\t\t\t\t\t<span class="wf-alert-dismiss">&times;</span>\t\t\t\t\t\t\t\t\t\t\t<div class="wf-alert-content"></div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t'),i(".wf-alert-content","#wf-alert-popup").text(t),i("#wf-alert-popup").show()}function o(t,a){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(a)),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}i(".datepicker").datepicker(),i(".wc-affiliate-chosen").chosen(),i(".wf-remove-affiliate").click(function(t){var a=i(this).data("id");i.ajax({url:ajaxurl,type:"POST",data:{action:"wf-remove-affiliate",id:a,nonce:WCAFFILIATE.nonce},dataType:"JSON",success:function(t){alert(t.message),location.reload()}})}),i(document).on("click","#wc-affiliate-export-report-btn",function(t){t.preventDefault();var a=i(this).data("params"),e=i(this).data("headings"),n=i(this).data("name");i.ajax({url:ajaxurl,data:{action:"wf-export-report",data:a,headings:e},type:"POST",dataType:"html",success:function(t){o("wc-affiliate-"+n+"-report.csv",t)}})}),i(document).on("submit","#wf-transaction-form",function(t){t.preventDefault();var a=i(this).serializeArray();i("#wf-transaction-notice").text(""),i.ajax({url:ajaxurl,data:a,type:"POST",dataType:"JSON",success:function(t){console.log(t),1==t.status?(r(t.message),setTimeout(function(){window.location.replace(WCAFFILIATE.admin_url+"?page=transactions")},2500)):r(t.message,"danger")}})}),i(document).on("click",".wf-review-action",function(t){t.preventDefault();var a=i(this).data("action"),e=i(this).data("id"),n=i("#wf-affiliate-message").val(),o=i("#wf-affiliate-email").val();i.ajax({url:ajaxurl,data:{action:"wf-review-action",nonce:WCAFFILIATE.nonce,review_action:a,user_id:e,message:n,email:o},type:"POST",dataType:"JSON",success:function(t){1==t.status?r(t.message):r(t.message,"danger")}})}),i(document).on("click",".wf-payout",function(t){t.preventDefault(),i.ajax({url:ajaxurl,data:{_wpnonce:WCAFFILIATE.nonce,action:"wf-payout",affiliate:i(this).data("affiliate"),from:i(this).data("from"),to:i(this).data("to")},type:"POST",dataType:"JSON",success:function(t){1==t.status?(r(t.message),setTimeout(function(){window.location=t.redirect},1500)):r(t.message,"danger")}})}),i(document).on("click",".wf-alert-dismiss, #wf-alert-overlay",function(t){i("#wf-alert-overlay").remove()}),i(document).on("click",".wf-import-export-nav-tabs a",function(t){t.preventDefault();var a=i(this).attr("data-tab");i(".wf-import-export-tabs-content .wf-import-export-tab").slideUp(),i("#wf-tab-content-"+a).slideDown()}),i(document).on("click",".wf-export-table-data-btn",function(t){t.preventDefault();var a=i(this).data("name");i.ajax({url:ajaxurl,data:{action:"wf-export-table-report",name:a},type:"POST",dataType:"html",success:function(t){console.log(t),o("wc-affiliate-"+a+"-report.csv",t)}})}),i("#wf-import-report-form").submit(function(t){t.preventDefault();var a=i(this),e=new FormData(a[0]);i.ajax({url:ajaxurl,type:"POST",data:e,processData:!1,contentType:!1,dataType:"JSON",success:function(t){console.log(t)}})})});